# 요구사항별 테스트 케이스 매트릭스

모든 항목은 `requirements.md`의 ID를 그대로 사용하며, **각 요구사항당 최소 3개의 테스트 케이스**를 제공한다.  
`Scenario`는 상황 설명, `Steps`는 핵심 절차, `Expected Result`는 합격 기준이다.

## P1 - 작업 흐름 연속성 유지
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| P1-TC1 | 파일 추가 중 다른 UI 조작 | 드래그 중 메시지/버튼 클릭 허용 여부 관찰 | 드래그가 중단되지 않고 추가 UI가 정상 반응 |
| P1-TC2 | 다중 파일 연속 드롭 | 3개 폴더를 순차 드롭 | 각 드롭 후 곧바로 다음 드롭 가능, 지연 없음 |
| P1-TC3 | 오류 발생 후 복귀 흐름 | 잘못된 파일 추가→경고 닫기→정상 파일 추가 | 경고 후에도 UI 상태가 초기화되지 않고 곧바로 정상 처리 |

## P2 - 사용자 선택 필요 상황 명확 표시
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| P2-TC1 | 시트 선택 필요 | 단일 파일, 다수 시트 | 시트 선택 창이 즉시 최상단에 표시 |
| P2-TC2 | 헤더 미검출 알림 | 헤더가 비는 시트 | 사용자에게 명확한 메시지/가이드 제공 |
| P2-TC3 | 저장 경고 | 미리보기 비어 있을 때 저장 버튼 클릭 | 저장 전 경고창이 뜨며 조치 안내 |

## P3 - 자동화 우선
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| P3-TC1 | 2번째 파일 자동 시트 추천 | 첫 파일 선택 후 유사 파일 추가 | 기존 헤더 기반 추천이 자동 적용 |
| P3-TC2 | 단일 시트 자동 적용 | 미리보기 존재 상태에서 단일 시트 파일 추가 | 팝업 없이 자동 반영 |
| P3-TC3 | 헤더 자동 인식 | 다양한 병합 헤더 파일 로드 | 수동 지정 없이 올바른 헤더 결정 |

## P4 - 원본 Excel 구조 보존
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| P4-TC1 | 병합 셀 포함 저장 | 다단 헤더 파일 합산 후 저장 | 결과물에서 동일 병합 구조 재현 |
| P4-TC2 | 서식 설명 영역 유지 | 헤더 위 안내 문구 존재 파일 저장 | 헤더 위 영역 포함한 채로 출력 |
| P4-TC3 | 열 순서 유지 | 입력 순서 다른 두 파일 병합 | 각 열은 최초 발견 순서를 유지 |

## FR-FILE-01 - 드래그 앤 드롭
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| FILE01-TC1 | 단일 파일 드롭 | 탐색기에서 하나 드래그 | 파일 목록에 즉시 추가 |
| FILE01-TC2 | 다중 선택 드롭 | 5개 파일 한번에 드래그 | 모두 목록에 추가되고 중간 누락 없음 |
| FILE01-TC3 | 폴더 드롭 | 서브폴더 포함 폴더 드래그 | 폴더 내 엑셀만 재귀적으로 추가 |

## FR-FILE-02 - 파일 불러오기 버튼
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| FILE02-TC1 | 버튼 클릭 후 선택 | “파일 불러오기” 클릭 | Windows 파일 선택 창 표시 |
| FILE02-TC2 | 여러 파일 선택 | 다중 선택 후 열기 | 선택한 파일이 모두 목록에 추가 |
| FILE02-TC3 | 취소 동작 | 창에서 취소 | 목록에 아무 변화 없음 |

## FR-FILE-03 - 중복 처리 정책
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| FILE03-TC1 | 동일 파일 재드롭 | 같은 파일 연속 드롭 | 중복 정책에 따라 덮어쓰기/무시 메시지 명확 |
| FILE03-TC2 | 다른 경로 동일 이름 | 다른 폴더지만 이름 같음 | 개별 항목으로 식별 가능 |
| FILE03-TC3 | 목록에서 제거 후 재추가 | 삭제→재드롭 | 새 항목으로 정상 추가 |

## FR-SHEET-01 - 모든 시트 스캔
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| SHEET01-TC1 | 10개 시트 파일 | 로드 후 시트 선택 열람 | 모든 시트 이름이 목록에 표시 |
| SHEET01-TC2 | 숨김 시트 존재 | 숨김 시트 포함 파일 | 숨김 시트도 후보에 포함되거나 명시적 제외 안내 |
| SHEET01-TC3 | 보호 시트 | 암호 없는 보호 시트 | 읽기 가능 여부 명확히 표시 (가능 시 로드) |

## FR-SHEET-02 - 최적 시트 감지 및 미리보기
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| SHEET02-TC1 | 미리보기 존재 + 최적 시트 1개 추천 | 파일A 선택 후 파일B 입력, 추천 결과가 단일 시트 | 팝업 없이 자동으로 해당 시트 적용 및 미리보기 즉시 갱신 |
| SHEET02-TC2 | 여러 유사 시트 | 비슷한 헤더 3개 | 최고 점수 시트가 기본 선택으로 강조, 사용자가 확정 가능 |
| SHEET02-TC3 | 수동 선택 변경 | 팝업에서 다른 시트 선택 | 선택 즉시 미리보기 갱신 |

## FR-SHEET-03 - 다중 시트 알림
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| SHEET03-TC1 | 2개 이상 시트 발견 | 파일 추가 시 | 팝업이 최상단, 작업표시줄 깜빡임 확인 |
| SHEET03-TC2 | 팝업에서 선택 지연 | 팝업 켠 채 다른 창 전환 | 창이 계속 최상단 유지 |
| SHEET03-TC3 | 사용자 취소 | 팝업에서 취소 선택 | 파일 추가가 보류되고 목록에 없음 |

## FR-SHEET-04 - 미리보기 없음 시 시트 선택 강제
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| SHEET04-TC1 | 초기 상태에서 다중 시트 파일 추가 | 앱 실행 후 바로 파일 드롭 | 미리보기 없으므로 시트 선택 창 표시 (단일 시트면 FR-SHEET-05 우선 적용) |
| SHEET04-TC2 | 파일/시트 선택 후 모두 제거 → 다중 시트 파일 재추가 | 선택 → “모두 제거” → 재드롭 | 미리보기가 비어 있으므로 다시 시트 선택 창 표시 |
| SHEET04-TC3 | 시트 추천 존재하지만 미리보기 없음 | 첫 파일에서 후보 3개 | 자동 적용하지 않고 팝업에서 사용자 확인 |

## FR-SHEET-05 - 단일 시트 파일은 항상 팝업 없이 적용
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| SHEET05-TC1 | 초기 상태에서 단일 시트 파일 추가 | 미리보기 없음 → 단일 시트 파일 드롭 | 팝업 없이 즉시 적용 및 미리보기 갱신 |
| SHEET05-TC2 | 파일 선택 후 모두 제거 → 다시 단일 시트 파일 | 선택 → “모두 제거” → 동일 파일 드롭 | 여전히 팝업 없이 바로 적용 |
| SHEET05-TC3 | 다른 파일 추가로 미리보기 존재 중 | 단일 시트 파일 추가 | 팝업 없이 추가 파일도 즉시 적용 (미리보기에 반영) |

## FR-HEADER-01 - 다단 헤더 인식
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| HEADER01-TC1 | 2단 헤더 | 병합 2행 헤더 파일 로드 | 최종 열 이름이 “상위 | 하위” 형식 |
| HEADER01-TC2 | 3단 헤더 | 3행 구조 | 모든 계층 결합 문자열 생성 |
| HEADER01-TC3 | 빈 셀 포함 | 상위 셀 일부 공백 | 공백은 건너뛰고 남은 계층 연결 |

## FR-HEADER-02 - 병합 범위 정보 보존
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| HEADER02-TC1 | 가로 병합 | 넓은 병합 헤더 내보내기 | 동일 폭으로 재병합 |
| HEADER02-TC2 | 세로 병합 | 세로 병합 헤더 | 저장 시 세로 병합 반복 적용 |
| HEADER02-TC3 | 혼합 병합 | 가로+세로 | 두 방향 병합 모두 복원 |

## FR-HEADER-03 - 미리보기 직렬 표시
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| HEADER03-TC1 | 미리보기 컬럼명 확인 | UI에서 헤더 확인 | “상위 | 하위” 형식 그대로 표시 |
| HEADER03-TC2 | 동일 이름 중복 | 동일한 하위명 존재 | 자동으로 _2 붙여 중복 제거 |
| HEADER03-TC3 | 한글/영문 혼합 | 다양한 문자 | 인코딩 오류 없이 표시 |

## FR-AUTO-01 - 자동 시트 추천
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| AUTO01-TC1 | 동일 헤더 후속 파일 | 기준 파일 추가 후 유사 파일 추가 | 자동 추천 리스트 상위권 |
| AUTO01-TC2 | 전혀 다른 헤더 | 무관한 파일 | 추천 우선순위 낮게, 사용자 선택 요구 |
| AUTO01-TC3 | 일부 열만 일치 | 부분 공통 헤더 | 확률이 중간 수준으로 계산됨 |

## FR-MGMT-01 - 시트 변경/파일 제거 버튼
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| MGMT01-TC1 | 시트 선택 버튼 | 각 항목 버튼 클릭 | 해당 파일만 시트 팝업 표시 |
| MGMT01-TC2 | X 버튼 제거 | 항목 X 클릭 | 해당 파일만 목록에서 제거 |
| MGMT01-TC3 | 키보드 삭제 | 항목 선택 후 Delete | 동일 효과로 삭제 |

## FR-MGMT-02 - 모두 제거 버튼
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| MGMT02-TC1 | 여러 파일 후 Clear | “모두 제거” 클릭 | 목록/미리보기 초기화 |
| MGMT02-TC2 | Clear 후 추가 | 바로 새 파일 드롭 | 초기 상태에서 정상 작동 |
| MGMT02-TC3 | Clear 시 진행중 로딩 | 파싱 중 클릭 | 안전하게 중단 또는 완료 후 초기화 |

## FR-MGMT-03 - 목록 가변성
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| MGMT03-TC1 | 1~2개 파일 | 목록 높이 최소 유지 | 미리보기 영역 넓음 |
| MGMT03-TC2 | 10개 파일 | 스크롤 생김 | 항목이 잘리지 않고 정렬 |
| MGMT03-TC3 | 창 리사이즈 | 창 줄이기/늘리기 | 비율 유지, 목록/미리보기 모두 조정 |

## UX-01 - 미리보기 중심 화면
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| UX01-TC1 | 초기 상태 | 앱 실행 후 관찰 | 미리보기 영역이 전체의 다수를 차지 |
| UX01-TC2 | 파일 추가 후 | 3개 파일 로드 | 미리보기 자동 포커스/스크롤 가능 |
| UX01-TC3 | 창 축소 | 세로 공간 줄이기 | 미리보기 최소 높이 유지 |

## UX-02 - 최대 20줄 미리보기
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| UX02-TC1 | 5줄 데이터 | 미리보기 확인 | 모든 줄 표시 |
| UX02-TC2 | 25줄 데이터 | 스크롤하여 20줄 제한 확인 | 기본 20줄 + 스크롤 가능 |
| UX02-TC3 | 행 추가 후 갱신 | 파일 추가/제거 | 미리보기 자동 갱신, 상한 유지 |

## UX-03 - 팝업 최소화
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| UX03-TC1 | 단일 시트 | 새 파일 입력 | 팝업 없이 바로 적용 |
| UX03-TC2 | 이미 선택된 파일 수정 | “시트 선택” 클릭 | 필요 시에만 팝업 |
| UX03-TC3 | 저장 성공 | 저장 완료 | 간단한 완료 알림만 표시 |

## UX-ALERT-01 - 선택 필요시 적극 알림
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| ALERT01-TC1 | 다중 시트 파일 첫 추가 | 팝업 동작 | 창이 최상단, 작업표시줄 깜빡임 |
| ALERT01-TC2 | 팝업 무시 | 일정 시간 대기 | 알림이 계속 표시되어 사용자가 인지 가능 |
| ALERT01-TC3 | 두 번째 파일 | 추가 시 | 동일 동작 재현 |

## UX-ALERT-02 - 시트 수 ≥2
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| ALERT02-TC1 | 정확히 2개 | 팝업 확인 | 두 시트 모두 체크 가능 |
| ALERT02-TC2 | 5개 시트 | 팝업 스크롤 | 모든 후보 표시 |
| ALERT02-TC3 | 사용자 2개 선택 | 다중 체크 | 선택된 시트만 추출 |

## UX-ALERT-03 - 최초 파일 선택
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| ALERT03-TC1 | 첫 파일 다중 시트 | 팝업 기다림 | 최상단 유지 |
| ALERT03-TC2 | 첫 파일 단일 시트 | 팝업 없이 자동? (요구 참조) | 미리보기 없음 상태이므로 팝업 생략 없이 정보 표시 |
| ALERT03-TC3 | 첫 파일 취소 | 팝업 닫기 | 초기상태로 복귀 |

## OUT-01 - XLSX 출력
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| OUT01-TC1 | 기본 저장 | 저장 버튼 클릭 | `.xlsx` 생성 |
| OUT01-TC2 | 경로 없는 상태 | 취소 | 파일 생성 없음 |
| OUT01-TC3 | 다시 저장 | 동일 경로 덮어쓰기 | 정상 덮어쓰기 또는 경고 |

## OUT-02 - 병합 헤더 복원
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| OUT02-TC1 | 가로 병합 | 저장 파일 확인 | 가로 병합 유지 |
| OUT02-TC2 | 세로 병합 | 확인 | 세로 병합 유지 |
| OUT02-TC3 | 혼합 병합 | 확인 | 모든 병합 정확 |

## OUT-03 - 헤더 위 설명 포함
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| OUT03-TC1 | 안내 문구 포함 파일 | 저장 | 안내 문구 포함 |
| OUT03-TC2 | 여러 행 설명 | 다수 행 존재 | 전부 보존 |
| OUT03-TC3 | 설명 없음 | 빈 헤더 공간 | 추가 내용 없이 저장 |

## OUT-05 - 헤더 번역(서식 명 포함)
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| OUT05-TC1 | 서식 명시 데이터 | 저장 후 확인 | 서식명 포함 |
| OUT05-TC2 | 병합 + 서식 | 헤더 확인 | 연결 텍스트 유지 |
| OUT05-TC3 | 동적 서식 | 사용자 수정 후 저장 | 수정된 이름 반영 |

## NFR-01 - Windows 11 + PyQt
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| NFR01-TC1 | Windows 11 실행 | OS 정보 확인 | UI 렌더링 정상 |
| NFR01-TC2 | DPI 스케일링 | 고해상도 모니터 | 폰트/레이아웃 깨짐 없음 |
| NFR01-TC3 | PyQt 버전 호환 | 6.x 설치 | Import 오류 없음 |

## NFR-02 - openpyxl 활용
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| NFR02-TC1 | 병합 읽기 | openpyxl 호출 | 병합 정보 수집 |
| NFR02-TC2 | 데이터-only 모드 | 수식 포함 파일 | 값 계산 결과 로드 |
| NFR02-TC3 | 쓰기 시 openpyxl | 저장 파일 열어 확인 | 서식 정상 |

## NFR-03 - 30파일 8초 처리
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| NFR03-TC1 | 10파일 배치 | 타이머 측정 | 목표 시간 내 |
| NFR03-TC2 | 30파일 실제 | 다양한 데이터 | 8초 내 완료 또는 로그 보고 |
| NFR03-TC3 | 병목 분석 | 프로파일링 | 병목 위치 파악 가능 |

## NFR-04 - 1920×1080 최적화
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| NFR04-TC1 | 1080p 창 | 최대화 후 관찰 | UI 영역 균형 |
| NFR04-TC2 | 작은 화면(1366) | 크기 줄이기 | 중요 요소 사용 가능 |
| NFR04-TC3 | 듀얼 모니터 이동 | 다른 해상도로 드래그 | 레이아웃 재정렬 정상 |

## EX-01 - 파싱 실패 오류
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| EX01-TC1 | 손상된 파일 | 열기 시도 | 에러 메시지 + 로그 |
| EX01-TC2 | 암호 파일 | 암호 요청 | 사용자 안내 후 실패 처리 |
| EX01-TC3 | 허용되지 않는 확장자 | csv 드래그 | 무시 + 경고 |

## EX-02 - 헤더 미발견 안내
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| EX02-TC1 | 빈 시트 | 처리 시 | 헤더 부족 경고 |
| EX02-TC2 | 숫자 데이터만 | 헤더 판단 실패 | 사용자 수동 입력 안내 |
| EX02-TC3 | 병합 오류 | 병합 정보 불일치 | 대체 헤더 사용 여부 묻기 |

## EX-03 - 비정상 병합 로그
| Test ID | Scenario | Steps | Expected Result |
| --- | --- | --- | --- |
| EX03-TC1 | 좌표 겹치는 병합 | 로드 시 | 로그 파일에 기록 |
| EX03-TC2 | 매우 큰 병합 | 저장 시 | 경고 + 처리 결과 남김 |
| EX03-TC3 | 병합 해제 후 입력 | 사용자 수정 | 로그에 업데이트 |
