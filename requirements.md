# 프로젝트 요구사항 사양서 (requirements.md)

버전: v1.0 환경: 폐쇄망 Windows 11 · Python 3.10+ · PyQt 기반 GUI

## 0. 문서 목적

본 문서는 Excel 기반 데이터 취합 도구의 기능·UI·동작 규칙을 명확히
정의하여, 개발 과정에서 일관된 요구사항을 유지하는 것을 목적으로 한다.
PyQt GUI 구조, Excel 파싱 및 통합 로직, 사용자 알림 기준 등을 종합적으로
규정한다.

## 1. 상위 원칙 (Global Principles)

-   P1. 작업 흐름의 연속성 유지
-   P2. 사용자의 선택 필요 시 명확한 주의 환기
-   P3. 자동화 우선
-   P4. 원본 Excel 구조 보존

## 2. 기능 요구사항 (Functional Requirements)

### 2.1 파일 입력 (Drag & Drop / File Dialog)

-   FR-FILE-01: 메인 화면에 Excel 파일을 Drag & Drop하여 추가할 수
    있어야 한다.
-   FR-FILE-02: "파일 불러오기" 버튼 클릭 시 Windows 파일 탐색기를 열어
    Excel 파일을 선택할 수 있어야 한다.
-   FR-FILE-03: 중복 파일 입력 시 이전 항목을 덮을지 여부 결정.

### 2.2 시트 자동 인식 및 선택

-   FR-SHEET-01: 파일 로드 시 모든 시트를 스캔하여 헤더 후보를 분석한다.
-   FR-SHEET-02: 최적 시트를 자동 감지하여 미리보기를 즉시 갱신한다.
-   FR-SHEET-03: 취합 후보 시트가 2개 이상이면 팝업·최상단 고정·작업표시줄 깜빡임으로 사용자에게 적극 알린다.
-   FR-SHEET-04: 미리보기가 없는 상태에서는 기본적으로 시트 선택 창을 띄워 사용자가 직접 선택하도록 한다. 단, 실제 시트가 1개뿐인 경우에는 FR-SHEET-05가 우선한다.
-   FR-SHEET-05: 엑셀 파일을 추가했을 때 시트가 1개뿐이면 언제든 팝업 없이 즉시 적용하며, 다른 모든 조건보다 우선한다.
    깜빡임.

### 2.3 헤더 인식

-   FR-HEADER-01: 다단 헤더 및 병합 셀 인식.
-   FR-HEADER-02: 병합 범위 및 셀 정보 보존.
-   FR-HEADER-03: 미리보기에서는 직렬화 표시, 저장 시 병합 복원.

### 2.4 자동 시트/헤더 인식 (2차 입력 파일)

-   FR-AUTO-01: 기존 헤더 패턴 기반으로 새로운 파일에서 최적 시트를 자동
    추천.

### 2.5 파일·시트 관리 기능

-   FR-MGMT-01: "시트 변경", "파일 제거" 버튼 제공.
-   FR-MGMT-02: "모두 제거" 버튼 제공.
-   FR-MGMT-03: 파일 목록은 공간에 따라 자동 압축/스크롤 처리.

## 3. 사용자 경험(UX) 요구사항

-   UX-01: 미리보기 중심 화면.
-   UX-02: 20행 이상 미리보기 확보.
-   UX-03: 팝업 최소화.
-   UX-ALERT-01\~03: 선택이 필요한 사건에만 적극 알림.

## 4. 출력(저장) 요구사항

-   OUT-01: 단일 XLSX 생성.
-   OUT-02: 병합 셀 및 헤더 복원.
-   OUT-03: 파일 입력 순서대로 본문 이어붙이기.
-   OUT-05: 헤더 위 상단 영역(서식 설명 포함) 보존.

## 5. 비기능 요구사항

-   NFR-01: Windows 11 + PyQt5/6 환경.
-   NFR-02: openpyxl 등 표준 라이브러리 사용.
-   NFR-03: 30개 파일 8초 내 처리 목표.
-   NFR-04: 1920×1080 해상도 기준 최적화.

## 6. 예외 상황 처리

-   EX-01: 파싱 실패 시 상세 오류 표시.
-   EX-02: 헤더 미발견 시 사용자 지정 기능 제공.
-   EX-03: 비정상 병합 셀은 단일 셀 처리 후 로그 기록.

## 7. 변경 로그

-   v1.0: 최초 작성.
