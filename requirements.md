# 프로젝트 요구사항 요약 (requirements.md)

버전: v1.0 환경: 폐쇄망 Windows 11 · Python 3.10+ · PyQt 기반 GUI

## 0. 문서 목적

본 문서는 Excel 기반 데이터 취합 요구사항/기능·UI·작업 규칙을 명확히 정의하여, 개발 과정에서 요구사항 누락을 방지하는 것을 목적 으로 한다.

## 1. 상위 원칙 (Global Principles)

-   P1. 작업 흐름 연속성
-   P2. 사용자 선택 필요 시 명확한 표시
-   P3. 자동화 우선
-   P4. 원본 Excel 구조 보존

## 2. 기능 요구사항 (Functional Requirements)

### 2.1 파일 입력 (Drag & Drop / File Dialog)

-   FR-FILE-01: 메인 화면에 Excel 파일을 Drag & Drop하여 추가할 수 있다.
-   FR-FILE-02: “파일 불러오기” 버튼 클릭 시 Windows 파일 탐색기로 열어 Excel 파일을 선택/추가할 수 있다.
-   FR-FILE-03: 중복 파일 입력 시 덮어쓰기/무시 정책을 명확히 결정한다.

### 2.2 시트 자동 탐색 및 선택

-   FR-SHEET-01: 파일 로드 시 모든 시트를 스캔하여 헤더 후보를 분석한다.
-   FR-SHEET-02: 최적 시트를 자동 감지하여 미리보기를 즉시 갱신한다.
-   FR-SHEET-03: 취합 후보 시트가 2개 이상이면 팝업·최상단 고정·작업표시줄 깜빡임으로 사용자에게 적극 알린다.
-   FR-SHEET-04: 미리보기가 없는 상태에서는 기본적으로 시트 선택 창을 띄워 사용자가 직접 선택하도록 한다. 단, 실제 시트가 1개뿐인 경우에는 FR-SHEET-05가 우선한다.
-   FR-SHEET-05: 엑셀 파일을 추가했을 때 시트가 1개뿐이면 언제든 팝업 없이 즉시 적용하며, 다른 모든 조건보다 우선한다.

### 2.3 헤더 인식

-   FR-HEADER-01: 다단 헤더 및 병합 셀을 인식.
-   FR-HEADER-02: 병합 범위 등의 정보를 보존.
-   FR-HEADER-03: 미리보기에서 직렬 표시, 저장 시 병합 복원.

### 2.4 자동 시트/헤더 추천 (2번째 이후 파일)

-   FR-AUTO-01: 기존 헤더 패턴 기반으로 후속 파일에서 최적 시트를 자동 추천.

### 2.5 헤더 수동 보정 및 반복 사용

-   FR-HADJ-01: 가벼운 모델로 헤더 밴드를 1차 추정하고, 결과를 엑셀 유사 표 UI(데이터/헤더 행을 함께 표시)로 보여준다. UI에는 “헤더로 쓸 행을 드래그하거나 시작/끝 행을 조정하세요”와 같은 안내를 제공한다.
-   FR-HADJ-02: 사용자는 표에서 헤더 영역을 드래그/선택(위·아래 경계 조정)하여 시작/끝 행을 직접 변경할 수 있으며, 선택한 행 수와 동일하게 반영되어야 한다. 스핀버튼(↑/↓)으로도 정확히 1행씩 조정 가능해야 한다.
-   FR-HADJ-03: 사용자가 확정한 헤더 행과 해당 행의 데이터를 저장한다. 확정 이후에도 “헤더 다시 선택” 기능을 통해 언제든 재조정할 수 있어야 한다.
-   FR-HADJ-04: 이후 파일을 추가하면 자동 인식된 동일 위치의 헤더 데이터를 기존 저장본과 비교해 동일하면 팝업 없이 바로 적용한다.
-   FR-HADJ-05: 다를 경우 저장된 헤더 데이터를 기준으로 추정한 결과를 UI에 띄워 사용자가 다시 조정할 수 있게 한다(헤더 보정 UI 재사용).
-   FR-HADJ-06: 파일 목록이 비면 모든 헤더/시트 선택 상태와 캐시는 초기화되며, 새 파일 추가 시 다시 시트 선택·헤더 선택 과정을 거친다.
-   FR-HADJ-07: ?? ???? (1) ? ??? ??? ?, (2) ??? ??? ?? ? ???? ??? ?? ????. ?? ??? ?? ????? ?? ?? ? ?? ??? ?? ?? ??? ??? ??? ???.

### 2.6 파일·시트 관리 기능

-   FR-MGMT-01: “시트 변경”, “파일 제거” 버튼 제공.
-   FR-MGMT-02: “모두 제거” 버튼 제공.
-   FR-MGMT-03: 파일 목록은 공간에 따라 자동 축소/스크롤 처리.

## 3. 사용자경험(UX) 요구사항

-   UX-01: 미리보기 중심 화면.
-   UX-02: 20줄 이상 미리보기 제공.
-   UX-03: 팝업 최소화.
-   UX-ALERT-01~03: 선택/주의가 필요한 조건에서만 적극 알림.

## 4. 출력(저장) 요구사항

-   OUT-01: 출력 XLSX 생성.
-   OUT-02: 병합 셀 및 헤더 복원.
-   OUT-03: 헤더 위 설명 영역 포함.
-   OUT-05: 헤더 번역(서식 명 포함) 보존.

## 5. 비기능 요구사항

-   NFR-01: Windows 11 + PyQt5/6 환경.
-   NFR-02: openpyxl 등 표준 라이브러리 사용.
-   NFR-03: 30파일 8초 처리 목표.
-   NFR-04: 1920×1080 화면 기준 최적화.

## 6. 예외 상황 처리

-   EX-01: 파싱 실패 시 상세 오류 표시.
-   EX-02: 헤더 미발견 시 대체/수동 지정 기능 제공.
-   EX-03: 비정상 병합/서식은 로그 기록.

## 7. 변경로그

-   v1.0: 최초 작성.

-   FR-HADJ-08: ?? ?? ??? ??/? ?? ??(??)?? ??? ??? ??? ??? ??? ?? ?? ????? ??? ???? ?? ??? ??? ???.